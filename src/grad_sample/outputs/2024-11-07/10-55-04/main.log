[2024-11-07 10:55:04,281][root][INFO] - ---------------------------------------------------------------
[2024-11-07 10:55:04,282][root][INFO] - Env:
CUDA_VISIBLE_DEVICES: null
PYTHONOPTIMIZE: null

[2024-11-07 10:55:04,282][root][INFO] - Command line args:

[2024-11-07 10:55:04,283][root][INFO] - ---------------------------------------------------------------
[2024-11-07 10:55:04,286][root][INFO] - Run config:
device: '4'
solver_fn:
  _target_: netket.optimizer.solver.cholesky
lr: 0.001
diag_shift: 1.0e-10
n_iter: 2000
chunk_size_jac: 2
chunk_size_vmap: 1
save_every: 10
base_path: /scratch/.amisery/grad_sample/
model:
  _target_: grad_sample.models.ising.TFI
  L: 3
  h: 1.0
ansatz:
  _target_: netket.models.RBM
  alpha: 1
  param_dtype: complex
task:
  _target_: grad_sample.tasks.fullsum_analysis.FullSumPruning

[2024-11-07 10:55:04,286][root][INFO] - ---------------------------------------------------------------
[2024-11-07 10:55:12,507][jax._src.xla_bridge][INFO] - Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
[2024-11-07 10:55:12,525][jax._src.xla_bridge][INFO] - Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
[2024-11-07 10:56:15,615][root][CRITICAL] - Cannot interpret 'Array([[[ 0.        -0.00000000e+00j, -0.        +0.00000000e+00j,
          0.        -0.00000000e+00j, ...,  0.        +0.00000000e+00j,
          0.        +0.00000000e+00j,  0.        +0.00000000e+00j],
        [-0.00143222-5.47144266e-04j, -0.00082367+5.92787887e-04j,
         -0.00024175-1.29640087e-03j, ...,  0.04503245+0.00000000e+00j,
          0.04424998+0.00000000e+00j, -0.04396322+0.00000000e+00j],
        [ 0.00131166+7.07631667e-04j, -0.00060926+6.36350894e-04j,
          0.00024634-1.68599520e-03j, ...,  0.04285656+0.00000000e+00j,
         -0.04403739+0.00000000e+00j,  0.04431029+0.00000000e+00j],
        ...,
        [-0.00130902-7.01981083e-04j,  0.00065843-6.78368056e-04j,
         -0.00027325+1.74534287e-03j, ..., -0.04567826+0.00000000e+00j,
          0.04443237+0.00000000e+00j, -0.04414443+0.00000000e+00j],
        [ 0.00143598+5.63518137e-04j,  0.00079974-5.71294251e-04j,
          0.00021739+1.20369575e-03j, ..., -0.04334962+0.00000000e+00j,
         -0.04409526+0.00000000e+00j,  0.04436853+0.00000000e+00j],
        [ 0.00032181+1.12102044e-04j,  0.00105287-6.39867425e-04j,
          0.00011275+1.14673576e-03j, ..., -0.0445239 +0.00000000e+00j,
         -0.04528974+0.00000000e+00j, -0.04302883+0.00000000e+00j]],

       [[-0.00025081-6.93622217e-05j, -0.00103181+6.30238768e-04j,
         -0.00012564-1.17353286e-03j, ...,  0.04385546+0.00000000e+00j,
          0.04309344+0.00000000e+00j,  0.04516247+0.00000000e+00j],
        [ 0.        -0.00000000e+00j, -0.        +0.00000000e+00j,
          0.        -0.00000000e+00j, ...,  0.        +0.00000000e+00j,
          0.        +0.00000000e+00j, -0.        +0.00000000e+00j],
        [ 0.0013094 +7.06732254e-04j, -0.00060894+6.36343990e-04j,
          0.00024612-1.68638527e-03j, ...,  0.0428634 +0.00000000e+00j,
         -0.04403525+0.00000000e+00j,  0.04414084+0.00000000e+00j],
        ...,
        [-0.00131153-7.03007060e-04j,  0.00065884-6.78447093e-04j,
         -0.00027352+1.74511865e-03j, ..., -0.04567588+0.00000000e+00j,
          0.04443946+0.00000000e+00j, -0.04432805+0.00000000e+00j],
        [ 0.00143373+5.62609832e-04j,  0.00080014-5.71365405e-04j,
          0.00021716+1.20345889e-03j, ..., -0.04334736+0.00000000e+00j,
         -0.04409312+0.00000000e+00j,  0.04419885+0.00000000e+00j],
        [ 0.00031944+1.11144327e-04j,  0.00105329-6.39943329e-04j,
          0.00011252+1.14648772e-03j, ..., -0.04452158+0.00000000e+00j,
         -0.04528754+0.00000000e+00j, -0.04320781+0.00000000e+00j]],

       [[-0.00024544-6.69208922e-05j, -0.00103122+6.30203462e-04j,
         -0.00012468-1.17403401e-03j, ...,  0.04384275+0.00000000e+00j,
          0.04291743+0.00000000e+00j,  0.04532993+0.00000000e+00j],
        [-0.0014291 -5.45604639e-04j, -0.00082276+5.92745602e-04j,
         -0.00024101-1.29729133e-03j, ...,  0.04502658+0.00000000e+00j,
          0.04407628+0.00000000e+00j, -0.04396536+0.00000000e+00j],
        [ 0.        +0.00000000e+00j, -0.        +0.00000000e+00j,
          0.        +0.00000000e+00j, ...,  0.        +0.00000000e+00j,
         -0.        +0.00000000e+00j,  0.        +0.00000000e+00j],
        ...,
        [-0.00130589-7.00428481e-04j,  0.00065927-6.78355194e-04j,
         -0.00027251+1.74431639e-03j, ..., -0.04568021+0.00000000e+00j,
          0.04425796+0.00000000e+00j, -0.04414658+0.00000000e+00j],
        [ 0.00143883+5.64938173e-04j,  0.00080054-5.71285193e-04j,
          0.00021807+1.20274126e-03j, ..., -0.04335147+0.00000000e+00j,
         -0.04425704+0.00000000e+00j,  0.04436274+0.00000000e+00j],
        [ 0.00032478+1.13580818e-04j,  0.00105368-6.39855816e-04j,
          0.00011346+1.14575930e-03j, ..., -0.04452579+0.00000000e+00j,
         -0.0454559 +0.00000000e+00j, -0.04303092+0.00000000e+00j]],

       ...,

       [[-0.00025058-6.96775157e-05j, -0.00102885+6.27702414e-04j,
         -0.00012571-1.16745980e-03j, ...,  0.04367447+0.00000000e+00j,
          0.04309453+0.00000000e+00j,  0.04516212+0.00000000e+00j],
        [-0.0014345 -5.48485798e-04j, -0.00082031+5.90171298e-04j,
         -0.00024208-1.29054922e-03j, ...,  0.04485376+0.00000000e+00j,
          0.04425816+0.00000000e+00j, -0.0441472 +0.00000000e+00j],
        [ 0.00130965+7.06430647e-04j, -0.00060605+6.33865183e-04j,
          0.00024606-1.68045416e-03j, ...,  0.04268651+0.00000000e+00j,
         -0.04403491+0.00000000e+00j,  0.04414051+0.00000000e+00j],
        ...,
        [ 0.        -0.00000000e+00j,  0.        +0.00000000e+00j,
         -0.        +0.00000000e+00j, ..., -0.        +0.00000000e+00j,
          0.        +0.00000000e+00j, -0.        +0.00000000e+00j],
        [ 0.00143398+5.62306601e-04j,  0.00080304-5.73857697e-04j,
          0.0002171 +1.20942228e-03j, ..., -0.04352522+0.00000000e+00j,
         -0.04409278+0.00000000e+00j,  0.04419852+0.00000000e+00j],
        [ 0.00031968+1.10828932e-04j,  0.00105628-6.42503583e-04j,
          0.00011245+1.15261189e-03j, ..., -0.04470425+0.00000000e+00j,
         -0.04528719+0.00000000e+00j, -0.0432089 +0.00000000e+00j]],

       [[-0.0002452 -6.71931894e-05j, -0.00102855+6.27911301e-04j,
         -0.00012474-1.16854886e-03j, ...,  0.04367912+0.00000000e+00j,
          0.04291731+0.00000000e+00j,  0.04533026+0.00000000e+00j],
        [-0.00142886-5.45885452e-04j, -0.00082002+5.90391416e-04j,
         -0.00024107-1.29165829e-03j, ...,  0.04485853+0.00000000e+00j,
          0.04407616+0.00000000e+00j, -0.04396524+0.00000000e+00j],
        [ 0.00131474+7.08779299e-04j, -0.00060579+6.34067256e-04j,
          0.00024697-1.68146323e-03j, ...,  0.04269105+0.00000000e+00j,
         -0.04419928+0.00000000e+00j,  0.04430484+0.00000000e+00j],
        ...,
        [-0.00130565-7.00710824e-04j,  0.00066204-6.80722191e-04j,
         -0.00027257+1.74998008e-03j, ..., -0.04584917+0.00000000e+00j,
          0.04425784+0.00000000e+00j, -0.04414646+0.00000000e+00j],
        [ 0.        +0.00000000e+00j,  0.        +0.00000000e+00j,
          0.        +0.00000000e+00j, ..., -0.        +0.00000000e+00j,
         -0.        +0.00000000e+00j,  0.        +0.00000000e+00j],
        [ 0.00032502+1.13307553e-04j,  0.00105637-6.42162943e-04j,
          0.00011341+1.15127851e-03j, ..., -0.04469049+0.00000000e+00j,
         -0.04545623+0.00000000e+00j, -0.0430308 +0.00000000e+00j]],

       [[-0.00024732-6.80488319e-05j, -0.00102806+6.27779835e-04j,
         -0.00012494-1.16865730e-03j, ...,  0.04367681+0.00000000e+00j,
          0.04291489+0.00000000e+00j,  0.04516422+0.00000000e+00j],
        [-0.00143109-5.46788555e-04j, -0.00081951+5.90253617e-04j,
         -0.00024128-1.29177433e-03j, ...,  0.04485616+0.00000000e+00j,
          0.04407367+0.00000000e+00j, -0.04414038+0.00000000e+00j],
        [ 0.00131275+7.07982567e-04j, -0.00060529+6.33939803e-04j,
          0.0002468 -1.68159677e-03j, ...,  0.04268879+0.00000000e+00j,
         -0.04420605+0.00000000e+00j,  0.04414256+0.00000000e+00j],
        ...,
        [-0.00130788-7.01625443e-04j,  0.00066262-6.80925604e-04j,
         -0.00027278+1.75001918e-03j, ..., -0.0458562 +0.00000000e+00j,
          0.04425533+0.00000000e+00j, -0.04432232+0.00000000e+00j],
        [ 0.00143708+5.63868037e-04j,  0.00080372-5.73720687e-04j,
          0.00021784+1.20812910e-03j, ..., -0.04351849+0.00000000e+00j,
         -0.04426415+0.00000000e+00j,  0.04420058+0.00000000e+00j],
        [ 0.        +0.00000000e+00j,  0.        +0.00000000e+00j,
          0.        +0.00000000e+00j, ..., -0.        +0.00000000e+00j,
         -0.        +0.00000000e+00j, -0.        +0.00000000e+00j]]],      dtype=complex128)' as a data type
Traceback (most recent call last):
  File "/home/amisery/phd/tfi_gs_samples/grad_sample/src/grad_sample/main.py", line 50, in main
    task()
  File "/home/amisery/phd/tfi_gs_samples/grad_sample/src/grad_sample/tasks/fullsum_analysis.py", line 61, in __call__
    in_idx, fid_vals, dp_dist_ev, infid_ev = self.prune()
                                             ^^^^^^^^^^^^
  File "/home/amisery/phd/tfi_gs_samples/grad_sample/src/grad_sample/tasks/fullsum_analysis.py", line 221, in prune
    in_idx, fid_vals = self.get_change(jnp.arange(self.jacobian_orig.shape[0])) #compute infidelity change on entire basis
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/amisery/phd/tfi_gs_samples/grad_sample/src/grad_sample/tasks/fullsum_analysis.py", line 147, in get_change
    fid_vals = self.vmap_change(indices)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/amisery/phd/tfi_gs_samples/grad_sample/src/grad_sample/tasks/fullsum_analysis.py", line 170, in compute_change
    dp_sol = self.get_new_dp(jac_new, Hloc_new)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/amisery/phd/tfi_gs_samples/grad_sample/src/grad_sample/tasks/fullsum_analysis.py", line 204, in get_new_dp
    new_rhs = jac_new.transpose().conj() @ Hloc_new
              ^^^^^^^^^^^^^^^^^^^
  File "/scratch/.amisery/netket/lib/python3.11/site-packages/jax/_src/numpy/array_methods.py", line 1056, in meth
    return getattr(self.aval, name).fun(self, *args, **kwargs)
                   ^^^^^^^^^
TypeError: Cannot interpret 'Array([[[ 0.        -0.00000000e+00j, -0.        +0.00000000e+00j,
          0.        -0.00000000e+00j, ...,  0.        +0.00000000e+00j,
          0.        +0.00000000e+00j,  0.        +0.00000000e+00j],
        [-0.00143222-5.47144266e-04j, -0.00082367+5.92787887e-04j,
         -0.00024175-1.29640087e-03j, ...,  0.04503245+0.00000000e+00j,
          0.04424998+0.00000000e+00j, -0.04396322+0.00000000e+00j],
        [ 0.00131166+7.07631667e-04j, -0.00060926+6.36350894e-04j,
          0.00024634-1.68599520e-03j, ...,  0.04285656+0.00000000e+00j,
         -0.04403739+0.00000000e+00j,  0.04431029+0.00000000e+00j],
        ...,
        [-0.00130902-7.01981083e-04j,  0.00065843-6.78368056e-04j,
         -0.00027325+1.74534287e-03j, ..., -0.04567826+0.00000000e+00j,
          0.04443237+0.00000000e+00j, -0.04414443+0.00000000e+00j],
        [ 0.00143598+5.63518137e-04j,  0.00079974-5.71294251e-04j,
          0.00021739+1.20369575e-03j, ..., -0.04334962+0.00000000e+00j,
         -0.04409526+0.00000000e+00j,  0.04436853+0.00000000e+00j],
        [ 0.00032181+1.12102044e-04j,  0.00105287-6.39867425e-04j,
          0.00011275+1.14673576e-03j, ..., -0.0445239 +0.00000000e+00j,
         -0.04528974+0.00000000e+00j, -0.04302883+0.00000000e+00j]],

       [[-0.00025081-6.93622217e-05j, -0.00103181+6.30238768e-04j,
         -0.00012564-1.17353286e-03j, ...,  0.04385546+0.00000000e+00j,
          0.04309344+0.00000000e+00j,  0.04516247+0.00000000e+00j],
        [ 0.        -0.00000000e+00j, -0.        +0.00000000e+00j,
          0.        -0.00000000e+00j, ...,  0.        +0.00000000e+00j,
          0.        +0.00000000e+00j, -0.        +0.00000000e+00j],
        [ 0.0013094 +7.06732254e-04j, -0.00060894+6.36343990e-04j,
          0.00024612-1.68638527e-03j, ...,  0.0428634 +0.00000000e+00j,
         -0.04403525+0.00000000e+00j,  0.04414084+0.00000000e+00j],
        ...,
        [-0.00131153-7.03007060e-04j,  0.00065884-6.78447093e-04j,
         -0.00027352+1.74511865e-03j, ..., -0.04567588+0.00000000e+00j,
          0.04443946+0.00000000e+00j, -0.04432805+0.00000000e+00j],
        [ 0.00143373+5.62609832e-04j,  0.00080014-5.71365405e-04j,
          0.00021716+1.20345889e-03j, ..., -0.04334736+0.00000000e+00j,
         -0.04409312+0.00000000e+00j,  0.04419885+0.00000000e+00j],
        [ 0.00031944+1.11144327e-04j,  0.00105329-6.39943329e-04j,
          0.00011252+1.14648772e-03j, ..., -0.04452158+0.00000000e+00j,
         -0.04528754+0.00000000e+00j, -0.04320781+0.00000000e+00j]],

       [[-0.00024544-6.69208922e-05j, -0.00103122+6.30203462e-04j,
         -0.00012468-1.17403401e-03j, ...,  0.04384275+0.00000000e+00j,
          0.04291743+0.00000000e+00j,  0.04532993+0.00000000e+00j],
        [-0.0014291 -5.45604639e-04j, -0.00082276+5.92745602e-04j,
         -0.00024101-1.29729133e-03j, ...,  0.04502658+0.00000000e+00j,
          0.04407628+0.00000000e+00j, -0.04396536+0.00000000e+00j],
        [ 0.        +0.00000000e+00j, -0.        +0.00000000e+00j,
          0.        +0.00000000e+00j, ...,  0.        +0.00000000e+00j,
         -0.        +0.00000000e+00j,  0.        +0.00000000e+00j],
        ...,
        [-0.00130589-7.00428481e-04j,  0.00065927-6.78355194e-04j,
         -0.00027251+1.74431639e-03j, ..., -0.04568021+0.00000000e+00j,
          0.04425796+0.00000000e+00j, -0.04414658+0.00000000e+00j],
        [ 0.00143883+5.64938173e-04j,  0.00080054-5.71285193e-04j,
          0.00021807+1.20274126e-03j, ..., -0.04335147+0.00000000e+00j,
         -0.04425704+0.00000000e+00j,  0.04436274+0.00000000e+00j],
        [ 0.00032478+1.13580818e-04j,  0.00105368-6.39855816e-04j,
          0.00011346+1.14575930e-03j, ..., -0.04452579+0.00000000e+00j,
         -0.0454559 +0.00000000e+00j, -0.04303092+0.00000000e+00j]],

       ...,

       [[-0.00025058-6.96775157e-05j, -0.00102885+6.27702414e-04j,
         -0.00012571-1.16745980e-03j, ...,  0.04367447+0.00000000e+00j,
          0.04309453+0.00000000e+00j,  0.04516212+0.00000000e+00j],
        [-0.0014345 -5.48485798e-04j, -0.00082031+5.90171298e-04j,
         -0.00024208-1.29054922e-03j, ...,  0.04485376+0.00000000e+00j,
          0.04425816+0.00000000e+00j, -0.0441472 +0.00000000e+00j],
        [ 0.00130965+7.06430647e-04j, -0.00060605+6.33865183e-04j,
          0.00024606-1.68045416e-03j, ...,  0.04268651+0.00000000e+00j,
         -0.04403491+0.00000000e+00j,  0.04414051+0.00000000e+00j],
        ...,
        [ 0.        -0.00000000e+00j,  0.        +0.00000000e+00j,
         -0.        +0.00000000e+00j, ..., -0.        +0.00000000e+00j,
          0.        +0.00000000e+00j, -0.        +0.00000000e+00j],
        [ 0.00143398+5.62306601e-04j,  0.00080304-5.73857697e-04j,
          0.0002171 +1.20942228e-03j, ..., -0.04352522+0.00000000e+00j,
         -0.04409278+0.00000000e+00j,  0.04419852+0.00000000e+00j],
        [ 0.00031968+1.10828932e-04j,  0.00105628-6.42503583e-04j,
          0.00011245+1.15261189e-03j, ..., -0.04470425+0.00000000e+00j,
         -0.04528719+0.00000000e+00j, -0.0432089 +0.00000000e+00j]],

       [[-0.0002452 -6.71931894e-05j, -0.00102855+6.27911301e-04j,
         -0.00012474-1.16854886e-03j, ...,  0.04367912+0.00000000e+00j,
          0.04291731+0.00000000e+00j,  0.04533026+0.00000000e+00j],
        [-0.00142886-5.45885452e-04j, -0.00082002+5.90391416e-04j,
         -0.00024107-1.29165829e-03j, ...,  0.04485853+0.00000000e+00j,
          0.04407616+0.00000000e+00j, -0.04396524+0.00000000e+00j],
        [ 0.00131474+7.08779299e-04j, -0.00060579+6.34067256e-04j,
          0.00024697-1.68146323e-03j, ...,  0.04269105+0.00000000e+00j,
         -0.04419928+0.00000000e+00j,  0.04430484+0.00000000e+00j],
        ...,
        [-0.00130565-7.00710824e-04j,  0.00066204-6.80722191e-04j,
         -0.00027257+1.74998008e-03j, ..., -0.04584917+0.00000000e+00j,
          0.04425784+0.00000000e+00j, -0.04414646+0.00000000e+00j],
        [ 0.        +0.00000000e+00j,  0.        +0.00000000e+00j,
          0.        +0.00000000e+00j, ..., -0.        +0.00000000e+00j,
         -0.        +0.00000000e+00j,  0.        +0.00000000e+00j],
        [ 0.00032502+1.13307553e-04j,  0.00105637-6.42162943e-04j,
          0.00011341+1.15127851e-03j, ..., -0.04469049+0.00000000e+00j,
         -0.04545623+0.00000000e+00j, -0.0430308 +0.00000000e+00j]],

       [[-0.00024732-6.80488319e-05j, -0.00102806+6.27779835e-04j,
         -0.00012494-1.16865730e-03j, ...,  0.04367681+0.00000000e+00j,
          0.04291489+0.00000000e+00j,  0.04516422+0.00000000e+00j],
        [-0.00143109-5.46788555e-04j, -0.00081951+5.90253617e-04j,
         -0.00024128-1.29177433e-03j, ...,  0.04485616+0.00000000e+00j,
          0.04407367+0.00000000e+00j, -0.04414038+0.00000000e+00j],
        [ 0.00131275+7.07982567e-04j, -0.00060529+6.33939803e-04j,
          0.0002468 -1.68159677e-03j, ...,  0.04268879+0.00000000e+00j,
         -0.04420605+0.00000000e+00j,  0.04414256+0.00000000e+00j],
        ...,
        [-0.00130788-7.01625443e-04j,  0.00066262-6.80925604e-04j,
         -0.00027278+1.75001918e-03j, ..., -0.0458562 +0.00000000e+00j,
          0.04425533+0.00000000e+00j, -0.04432232+0.00000000e+00j],
        [ 0.00143708+5.63868037e-04j,  0.00080372-5.73720687e-04j,
          0.00021784+1.20812910e-03j, ..., -0.04351849+0.00000000e+00j,
         -0.04426415+0.00000000e+00j,  0.04420058+0.00000000e+00j],
        [ 0.        +0.00000000e+00j,  0.        +0.00000000e+00j,
          0.        +0.00000000e+00j, ..., -0.        +0.00000000e+00j,
         -0.        +0.00000000e+00j, -0.        +0.00000000e+00j]]],      dtype=complex128)' as a data type
--------------------
For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
